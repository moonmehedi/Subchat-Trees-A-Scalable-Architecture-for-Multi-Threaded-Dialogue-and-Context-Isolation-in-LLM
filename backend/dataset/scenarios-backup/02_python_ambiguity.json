{
  "scenario_name": "Python Ambiguity - Context Isolation Test",
  "description": "Tests context isolation between main tree and subchats when discussing 'python' (snake vs programming)",
  "tree_type": "main_with_subchats",
  "conversations": [
    {
      "step": 1,
      "action": "send_message",
      "node_type": "main",
      "message": "How do you kill a python snake safely?",
      "expected_response_contains": ["snake", "python", "dangerous", "careful"]
    },
    {
      "step": 2,
      "action": "send_message",
      "node_type": "main",
      "message": "What tools do I need to handle a python snake?",
      "expected_response_contains": ["tools", "snake", "hook", "gloves"]
    },
    {
      "step": 3,
      "action": "send_message",
      "node_type": "main",
      "message": "Are python snakes venomous?",
      "expected_response_contains": ["not venomous", "constrictor"]
    },
    {
      "step": 4,
      "action": "create_subchat",
      "parent_node": "main",
      "subchat_name": "Python Programming",
      "message": "How do I write Python code for beginners?",
      "expected_response_contains": ["programming", "code", "syntax", "beginner"]
    },
    {
      "step": 5,
      "action": "send_message",
      "node_type": "subchat_1",
      "message": "Show me a hello world example in Python",
      "expected_response_contains": ["print", "hello world", "code"]
    },
    {
      "step": 6,
      "action": "send_message",
      "node_type": "subchat_1",
      "message": "How do I define a function in Python?",
      "expected_response_contains": ["def", "function", "return"]
    },
    {
      "step": 7,
      "action": "send_message",
      "node_type": "subchat_1",
      "message": "What are Python data types?",
      "expected_response_contains": ["int", "str", "list", "dict", "data types"]
    },
    {
      "step": 8,
      "action": "create_subchat",
      "parent_node": "main",
      "subchat_name": "Python Snake Habitat",
      "message": "Where do python snakes live in the wild?",
      "expected_response_contains": ["habitat", "tropical", "Asia", "Africa"]
    },
    {
      "step": 9,
      "action": "send_message",
      "node_type": "subchat_2",
      "message": "What do python snakes eat?",
      "expected_response_contains": ["prey", "rodents", "mammals", "eat"]
    },
    {
      "step": 10,
      "action": "send_message",
      "node_type": "subchat_2",
      "message": "How long can a python snake grow?",
      "expected_response_contains": ["length", "feet", "meters", "size"]
    },
    {
      "step": 11,
      "action": "switch_to_node",
      "node_type": "main",
      "message": "Is it legal to kill python snakes?",
      "expected_response_contains": ["legal", "law", "regulations"],
      "should_not_contain": ["programming", "code", "syntax"]
    },
    {
      "step": 12,
      "action": "send_message",
      "node_type": "main",
      "message": "What was my original question about pythons?",
      "expected_response_contains": ["kill", "safely", "snake"],
      "should_retrieve": true,
      "expected_retrieval": ["How do you kill a python snake safely"],
      "should_not_contain": ["programming", "code"]
    },
    {
      "step": 13,
      "action": "switch_to_node",
      "node_type": "subchat_1",
      "message": "What did I ask about Python earlier in this conversation?",
      "expected_response_contains": ["beginners", "hello world", "function"],
      "should_retrieve": true,
      "expected_retrieval": ["write Python code", "hello world"],
      "should_not_contain": ["snake", "kill", "venomous"]
    }
  ]
}
